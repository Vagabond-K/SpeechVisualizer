<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:SpeechVisualizer">

    <DataTemplate DataType="{x:Type local:Speaker}">
        <Grid Height="340" Width="340" Margin="30" RenderTransformOrigin="0.5,0.5" DataContext="{Binding AudioData}">
            <Grid.Effect>
                <DropShadowEffect Direction="270" BlurRadius="20" ShadowDepth="10"/>
            </Grid.Effect>
            <Ellipse Fill="{Binding Stroke, ElementName=Amoeba}" Width="304" Height="304"/>
            <Path Width="304" Height="291"  VerticalAlignment="Top" Margin="12,18,12,0" Stretch="Fill" Fill="#FF000000" Data="M 121.821,289.46C 121.821,293.044 120,297 113.394,297L 95.7284,296.7C 42.8321,272.915 5.99999,219.759 5.99999,158C 5.99999,74.0529 74.0527,6.00006 158,6.00006C 241.947,6.00006 310,74.0529 310,158C 310,219.759 273.168,272.915 220.271,296.7L 202.86,296.995C 196,296.991 194.208,293.134 194.208,289.46C 194.208,284.691 194.383,268.929 194.383,249.415C 194.383,235.805 189.711,226.907 184.484,222.399C 216.984,218.764 251.119,206.434 251.119,150.365C 251.119,134.429 245.483,121.401 236.11,111.193C 237.628,107.471 242.622,92.6396 234.679,72.5447C 234.679,72.5447 222.444,68.6187 194.558,87.5214C 182.908,84.2643 170.41,82.6649 158,82.6067C 145.59,82.6649 133.092,84.2643 121.442,87.5214C 93.5556,68.6187 81.2916,72.5447 81.2916,72.5447C 73.3784,92.6396 78.3716,107.471 79.89,111.193C 70.546,121.401 64.852,134.429 64.852,150.365C 64.852,206.288 98.9284,218.822 131.37,222.486C 127.194,226.151 123.398,232.577 122.084,242.029C 113.762,245.751 92.6212,252.207 79.598,229.902C 79.598,229.902 71.8892,215.885 57.2308,214.838C 57.2308,214.838 42.9812,214.664 56.238,223.708C 56.238,223.708 65.7864,228.215 72.444,245.082C 72.444,245.082 80.9996,273.465 121.617,264.654L 121.821,289.46 Z "/>
            <Path x:Name="Amoeba" Stroke="#FF808080" StrokeThickness="12">
                <Path.Data>
                    <PathGeometry local:Amoeba.Center="170,170" local:Amoeba.Radius="152.3" local:Amoeba.Corners="18" local:Amoeba.WaveThickness="0"/>
                </Path.Data>
                <Path.Style>
                    <Style TargetType="{x:Type Path}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsActivated}" Value="True">
                                <DataTrigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation To="White" Duration="0" Storyboard.TargetProperty="Stroke.Color"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard RepeatBehavior="Forever">
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="Data.(local:Amoeba.WaveThickness)">
                                                <LinearDoubleKeyFrame KeyTime="0" Value="0"/>
                                                <LinearDoubleKeyFrame KeyTime="0:0:0.08" Value="10"/>
                                                <LinearDoubleKeyFrame KeyTime="0:0:0.24" Value="-10"/>
                                                <LinearDoubleKeyFrame KeyTime="0:0:0.32" Value="0"/>
                                            </DoubleAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </DataTrigger.EnterActions>
                                <DataTrigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <ColorAnimation To="#FF808080" Duration="0:0:0.5" Storyboard.TargetProperty="Stroke.Color"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation To="0" Duration="0:0:0.5" Storyboard.TargetProperty="Data.(local:Amoeba.WaveThickness)"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </DataTrigger.ExitActions>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Path.Style>
            </Path>
        </Grid>
    </DataTemplate>
    
    <DataTemplate DataType="{x:Type local:Background}">
        <Canvas>
            <Canvas.Background>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="Black"/>
                    <GradientStop Color="#FF060031" Offset="1"/>
                </LinearGradientBrush>
            </Canvas.Background>
            <Canvas.Triggers>
                <EventTrigger RoutedEvent="Loaded">
                    <BeginStoryboard>
                        <Storyboard RepeatBehavior="Forever">
                            <DoubleAnimation Storyboard.TargetName="Wave1" Storyboard.TargetProperty="(Canvas.Left)" From="-1362" To="-20" Duration="0:0:20"/>
                        </Storyboard>
                    </BeginStoryboard>
                    <BeginStoryboard>
                        <Storyboard RepeatBehavior="Forever">
                            <DoubleAnimation Storyboard.TargetName="Wave2" Storyboard.TargetProperty="(Canvas.Left)" From="-2208" To="-224" Duration="0:0:15"/>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
            </Canvas.Triggers>
            <Path x:Name="Wave1" Width="2686" Height="1070" Canvas.Left="-1362" Canvas.Top="-621" Stretch="Fill" Fill="#10FFFFFF" Stroke="Gray" StrokeThickness="2" Data="F1 M 2666,360.015L 2666,-620.998L -19.9995,-620.998L -19.9995,360.015C 91.9172,404.506 203.834,449.002 315.751,449.002C 427.667,449.002 539.584,404.506 651.5,360.015C 763.417,315.525 875.334,271.034 987.25,271.034C 1099.17,271.034 1211.08,315.525 1323,360.015C 1434.92,404.506 1546.83,448.996 1658.75,448.996C 1770.67,448.996 1882.58,404.506 1994.5,360.015C 2106.42,315.525 2218.33,271.034 2330.25,271.034C 2442.17,271.034 2554.08,315.525 2666,360.015 Z "/>
            <Path x:Name="Wave2" Width="3970" Height="1426.56" Canvas.Left="-2208" Canvas.Top="241.443" Stretch="Fill" Fill="#10FFFFFF" Stroke="Gray" StrokeThickness="2" Data="F1 M 3746,360.082L 3746,1668L -224,1668L -224,360.082C -58.5833,300.766 106.833,241.443 272.25,241.443C 437.667,241.443 603.083,300.766 768.5,360.082C 933.917,419.399 1099.33,478.715 1264.75,478.715C 1430.17,478.715 1595.58,419.399 1761,360.082C 1926.42,300.766 2091.83,241.45 2257.25,241.45C 2422.67,241.45 2588.08,300.766 2753.5,360.082C 2918.92,419.399 3084.33,478.715 3249.75,478.715C 3415.17,478.715 3580.58,419.399 3746,360.082 Z "/>
        </Canvas>
    </DataTemplate>

</ResourceDictionary>